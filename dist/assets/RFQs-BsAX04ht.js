import{j as e}from"./vendor-query-Bcn4Fvtg.js";import{r as m}from"./vendor-react-DbHp_wuh.js";import{U as P,J as h,E as p,K as D,j as w,R as Q,B as C}from"./index-CDJVr2wI.js";import{B as n,T as q}from"./Badge-BGqaB6wT.js";import{M as A}from"./Modal-Cghr_C7K.js";import{B as I}from"./Button-CC2RlQoZ.js";import{a as M,b as z}from"./useRFQs-BfHvAP5M.js";import"./vendor-icons-BV48wJe3.js";import"./api--gIgMF1d.js";const K=()=>{const[t,i]=m.useState(null),[j,d]=m.useState(!1),[c,y]=m.useState("all"),{data:r=[],isLoading:N,error:o,refetch:g}=M(),b=z(),x=o?o.response?.data?.message||"Failed to fetch RFQs":null,f=async(s,a)=>{try{await b.mutateAsync({id:s,status:a}),alert("Status updated successfully!"),d(!1),i(null)}catch(l){console.error("Failed to update status:",l),alert(l.response?.data?.message||"Failed to update status")}},v=s=>{i(s),d(!0)},R=c==="all"?r:r.filter(s=>s.status===c),u=s=>{const a={PENDING:"warning",RESPONDED:"primary"};return e.jsx(n,{variant:a[s]||"default",children:s||"PENDING"})},F=s=>{const a=s.items||[];return a.length===0?"No items":a.length===1?a[0].product?.name||"Product":`${a[0].product?.name||"Product"} +${a.length-1} more`},k=s=>(s.items||[]).reduce((l,E)=>l+(E.quantity||0),0),S=[{label:"Company",key:"companyName",render:s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"text-gray-400"}),e.jsx("span",{className:"font-medium",children:s.companyName||"N/A"})]})},{label:"Contact",key:"contactName",render:s=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.contactName||"N/A"}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(p,{size:10})," ",s.email]})]})},{label:"Items",key:"items",render:s=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:F(s)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(s.items||[]).length," item(s) Â· Qty: ",k(s)]})]})},{label:"Country",key:"country",render:s=>s.country||"N/A"},{label:"Status",key:"status",render:s=>u(s.status)},{label:"Date",key:"createdAt",render:s=>new Date(s.createdAt).toLocaleDateString()},{label:"Actions",key:"actions",render:s=>e.jsx("button",{onClick:()=>v(s),className:"p-2 hover:bg-blue-50 rounded-lg transition-colors",title:"View Details",children:e.jsx(C,{size:16,className:"text-blue-600"})})}];return N?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),e.jsx("p",{className:"mt-4 text-secondary-text",children:"Loading RFQs..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-primary-text",children:"RFQ Management"}),e.jsx("p",{className:"text-secondary-text mt-1",children:"Manage customer quote requests"})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs(n,{variant:"warning",children:["Pending: ",r.filter(s=>s.status==="PENDING").length]}),e.jsxs(n,{variant:"primary",children:["Responded: ",r.filter(s=>s.status==="RESPONDED").length]}),e.jsxs(n,{variant:"default",children:["Total: ",r.length]}),e.jsxs(I,{variant:"outline",onClick:()=>g(),children:[e.jsx(P,{className:"inline mr-2"})," Refresh"]})]})]}),e.jsx("div",{className:"flex gap-2",children:[{key:"all",label:"All"},{key:"PENDING",label:"Pending"},{key:"RESPONDED",label:"Responded"}].map(s=>e.jsx("button",{onClick:()=>y(s.key),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c===s.key?"bg-primary text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:s.label},s.key))}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg",children:x}),r.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border border-border",children:[e.jsx(h,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-secondary-text mb-2",children:"No RFQs found"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Customer quote requests will appear here"})]}):e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-border overflow-hidden",children:e.jsx(q,{columns:S,data:R})}),t&&e.jsx(A,{isOpen:j,onClose:()=>{d(!1),i(null)},title:"RFQ Details",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-text mb-1",children:"Company"}),e.jsx("p",{className:"text-primary-text font-medium",children:t.companyName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-text mb-1",children:"Contact Name"}),e.jsx("p",{className:"text-primary-text font-medium",children:t.contactName||"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-1 text-sm font-medium text-secondary-text mb-1",children:[e.jsx(p,{size:14})," Email"]}),e.jsx("p",{className:"text-primary-text",children:t.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-1 text-sm font-medium text-secondary-text mb-1",children:[e.jsx(D,{size:14})," Phone"]}),e.jsx("p",{className:"text-primary-text",children:t.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-text mb-1",children:"Country"}),e.jsx("p",{className:"text-primary-text",children:t.country||"N/A"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-1 text-sm font-medium text-secondary-text mb-2",children:[e.jsx(w,{size:14})," Requested Items"]}),e.jsx("div",{className:"border border-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-left",children:[e.jsx("th",{className:"px-4 py-2 text-sm font-medium text-gray-600",children:"#"}),e.jsx("th",{className:"px-4 py-2 text-sm font-medium text-gray-600",children:"Product"}),e.jsx("th",{className:"px-4 py-2 text-sm font-medium text-gray-600",children:"Quantity"})]})}),e.jsx("tbody",{children:(t.items||[]).length>0?t.items.map((s,a)=>e.jsxs("tr",{className:"border-t border-border",children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:a+1}),e.jsx("td",{className:"px-4 py-2 text-sm font-medium",children:s.product?.name||`Product #${s.productId}`}),e.jsx("td",{className:"px-4 py-2 text-sm",children:s.quantity})]},a)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"px-4 py-4 text-center text-sm text-gray-500",children:"No items"})})})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-text mb-1",children:"Current Status"}),u(t.status)]}),t.message&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-text mb-1",children:"Message"}),e.jsx("p",{className:"text-primary-text bg-gray-50 p-4 rounded-lg",children:t.message})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-border",children:[e.jsxs("select",{className:"px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",defaultValue:t.status,onChange:s=>{const a=t.id||t._id;f(a,s.target.value)},children:[e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"RESPONDED",children:"Responded"})]}),e.jsxs("a",{href:`mailto:${t.email}?subject=Re: Your RFQ Request`,className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90",children:[e.jsx(h,{})," Send Email Response"]})]})]})})]})};export{K as default};
