import{j as e}from"./vendor-query-Bcn4Fvtg.js";import{r as c}from"./vendor-react-DbHp_wuh.js";import{U as $,x as C,H as b,e as O,Z as R,y as q}from"./index-CDJVr2wI.js";import{B as n}from"./Button-CC2RlQoZ.js";import{M as B}from"./Modal-Cghr_C7K.js";import{u as U,a as _,b as H,c as P}from"./useIndustries-j6syjGEe.js";import"./vendor-icons-BV48wJe3.js";import"./api--gIgMF1d.js";const Y=()=>{const[F,d]=c.useState(!1),[l,j]=c.useState(!1),[S,y]=c.useState(null),[m,M]=c.useState(""),[r,p]=c.useState({name:"",description:"",icon:""}),{data:u=[],isLoading:k,error:N,refetch:v}=U(),A=_(),D=H(),E=P(),w=N?N.response?.data?.message||"Failed to fetch industries":null,f=u.filter(s=>s.name.toLowerCase().includes(m.toLowerCase())||s.description&&s.description.toLowerCase().includes(m.toLowerCase())),o={total:u.length,filtered:f.length},L=async s=>{if(s.preventDefault(),!r.name||!r.name.trim()){alert("Industry name is required");return}try{const t={name:r.name.trim()};r.description&&r.description.trim()&&(t.description=r.description.trim()),r.icon&&r.icon.trim()&&(t.icon=r.icon.trim()),console.log("Submitting industry:",t),l?(await D.mutateAsync({id:S,data:t}),alert("Industry updated successfully!")):(await A.mutateAsync(t),alert("Industry created successfully!")),d(!1),x()}catch(t){console.error(`Failed to ${l?"update":"create"} industry:`,t);const i=t.response?.data?.errors;let a=t.response?.data?.message||`Failed to ${l?"update":"create"} industry`;i&&Array.isArray(i)&&i.length>0&&(a+=`

Details:
`+i.map(h=>`â€¢ ${h.path}: ${h.message}`).join(`
`)),alert(a)}},z=async(s,t)=>{const i=`Are you sure you want to delete "${t.name}"?

âš ï¸ Warning: This may affect suppliers and products linked to this industry.`;if(window.confirm(i))try{await E.mutateAsync(s),alert("Industry deleted successfully!")}catch(a){console.error("Failed to delete industry:",a);const h=a.response?.data?.message||"Failed to delete industry";alert(`Failed to delete industry:

${h}`)}},g=s=>{const{name:t,value:i}=s.target;p(a=>({...a,[t]:i}))},x=()=>{p({name:"",description:"",icon:""}),j(!1),y(null)},T=s=>{const t=s._id||s.id;j(!0),y(t),p({name:s.name,description:s.description||"",icon:s.icon||""}),d(!0)},I=()=>{x(),d(!0)};return k?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),e.jsx("p",{className:"mt-4 text-secondary-text",children:"Loading industries..."})]})}):w?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:w}),e.jsx(n,{onClick:()=>v(),children:"Retry"})]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-primary-text",children:"Industries"}),e.jsx("p",{className:"text-sm text-secondary-text mt-1",children:"Manage industry categories for suppliers and products"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(n,{variant:"outline",onClick:()=>v(),children:[e.jsx($,{className:"inline mr-2"})," Refresh"]}),e.jsxs(n,{onClick:I,children:[e.jsx(C,{className:"inline mr-2"})," Add Industry"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white p-5 rounded-lg shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Total Industries"}),e.jsx("h3",{className:"text-3xl font-bold mt-1",children:o.total})]}),e.jsx("div",{className:"bg-white bg-opacity-20 p-3 rounded-lg",children:e.jsx(b,{size:24})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white p-5 rounded-lg shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"Active Sectors"}),e.jsx("h3",{className:"text-3xl font-bold mt-1",children:o.total})]}),e.jsx("div",{className:"bg-white bg-opacity-20 p-3 rounded-lg",children:e.jsx(b,{size:24})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-indigo-600 text-white p-5 rounded-lg shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-100 text-sm font-medium",children:"Categories"}),e.jsx("h3",{className:"text-3xl font-bold mt-1",children:o.total})]}),e.jsx("div",{className:"bg-white bg-opacity-20 p-3 rounded-lg",children:e.jsx(b,{size:24})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-border p-4 mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search industries by name or description...",value:m,onChange:s=>M(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),m&&e.jsxs("p",{className:"text-sm text-secondary-text mt-2",children:["Showing ",e.jsx("span",{className:"font-semibold text-primary-text",children:o.filtered})," of ",e.jsx("span",{className:"font-semibold text-primary-text",children:o.total})," industries"]})]}),f.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border border-border",children:[e.jsx("p",{className:"text-secondary-text mb-4",children:u.length===0?"No industries found":"No industries match your search"}),u.length===0&&e.jsxs(n,{onClick:I,children:[e.jsx(C,{className:"inline mr-2"})," Create First Industry"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(s=>{const t=s._id||s.id;return e.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-md border-2 border-blue-100 p-6 hover:shadow-xl hover:border-blue-300 transition-all duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[s.icon&&e.jsx("div",{className:"bg-blue-100 p-3 rounded-xl",children:e.jsx("span",{className:"text-4xl",children:s.icon})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 italic",children:s.description})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>T(s),className:"p-2 hover:bg-blue-100 rounded-lg transition-colors",title:"Edit industry",children:e.jsx(R,{size:18,className:"text-blue-600"})}),e.jsx("button",{onClick:()=>z(t,s),className:"p-2 hover:bg-red-100 rounded-lg transition-colors",title:"Delete industry",children:e.jsx(q,{size:18,className:"text-red-600"})})]})]})},t)})}),e.jsx(B,{isOpen:F,onClose:()=>{d(!1),x()},title:l?"Edit Industry":"Add New Industry",children:e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-text mb-1",children:"Industry Name *"}),e.jsx("input",{type:"text",name:"name",value:r.name,onChange:g,required:!0,className:"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"e.g., Agriculture, Manufacturing, Technology"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-text mb-1",children:"Icon (Emoji)"}),e.jsx("input",{type:"text",name:"icon",value:r.icon,onChange:g,className:"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"ðŸ­",maxLength:"10"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Optional: Add an emoji icon"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-text mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:r.description,onChange:g,className:"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",rows:"3",placeholder:"Industry description..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border",children:[e.jsx(n,{variant:"outline",type:"button",onClick:()=>{d(!1),x()},children:"Cancel"}),e.jsx(n,{type:"submit",children:l?"Update Industry":"Save Industry"})]})]})})]})};export{Y as default};
