import{j as e}from"./vendor-query-Bcn4Fvtg.js";import{u as Y,r as l}from"./vendor-react-DbHp_wuh.js";import{F as A,j as Z,A as N,H as j,J as F,U as K,i as ee,V as k,b as P}from"./index-CDJVr2wI.js";import{B as m,T as z}from"./Badge-BGqaB6wT.js";import{B as se}from"./Button-CC2RlQoZ.js";import{g as f,r as te,s as ae,p as re,c as le,i as ie,b as D,e as o}from"./api--gIgMF1d.js";import"./vendor-icons-BV48wJe3.js";const he=()=>{const i=Y(),[d,E]=l.useState(null),[v,I]=l.useState([]),[n,T]=l.useState(null),[y,Q]=l.useState([]),[h,B]=l.useState([]),[x,O]=l.useState([]),[p,V]=l.useState([]),[a,G]=l.useState({}),[M,R]=l.useState(!0);l.useEffect(()=>{w()},[]);const w=async()=>{try{R(!0);const[s,t,c,g,$,H,J,W]=await Promise.all([f.getMetrics().catch(()=>null),f.getProductPopularity().catch(()=>null),f.getRfqAnalytics().catch(()=>null),te.getAll().catch(()=>null),ae.getAll().catch(()=>null),re.getAll().catch(()=>null),le.getAll().catch(()=>null),ie.getAll().catch(()=>null)]);E(D(s,{})),I(o(t)),T(D(c,{}));const u=o(g),C=o($),X=o(H),q=o(J),S=o(W);Q(u.slice(0,5)),B(C.slice(0,5)),O(q),V(S),G({suppliers:C.length,products:X.length,rfqs:u.length,categories:q.length,industries:S.length,pendingRfqs:u.filter(b=>b.status==="PENDING").length,respondedRfqs:u.filter(b=>b.status==="RESPONDED").length})}catch(s){console.error("Error fetching dashboard data:",s)}finally{R(!1)}},r=(s,t)=>d&&d[s]!==void 0?d[s]:d?.counts&&d.counts[s]!==void 0?d.counts[s]:t&&a[t]!==void 0?a[t]:0,U=[{title:"Total Suppliers",value:(r("totalSuppliers","suppliers")||r("suppliers","suppliers")||h.length).toString(),icon:e.jsx(A,{size:24}),color:"from-blue-500 to-blue-600",lightColor:"bg-blue-50 text-blue-600",onClick:()=>i("/admin/suppliers")},{title:"Total Products",value:(r("totalProducts","products")||r("products","products")||0).toString(),icon:e.jsx(Z,{size:24}),color:"from-emerald-500 to-emerald-600",lightColor:"bg-emerald-50 text-emerald-600",onClick:()=>i("/admin/products")},{title:"Categories",value:(r("totalCategories","categories")||r("categories","categories")||x.length).toString(),icon:e.jsx(N,{size:24}),color:"from-violet-500 to-violet-600",lightColor:"bg-violet-50 text-violet-600",onClick:()=>i("/admin/categories")},{title:"Industries",value:(r("totalIndustries","industries")||r("industries","industries")||p.length).toString(),icon:e.jsx(j,{size:24}),color:"from-amber-500 to-amber-600",lightColor:"bg-amber-50 text-amber-600",onClick:()=>i("/admin/industries")},{title:"Total RFQs",value:(r("totalRfqs","rfqs")||r("rfqs","rfqs")||0).toString(),icon:e.jsx(F,{size:24}),color:"from-rose-500 to-rose-600",lightColor:"bg-rose-50 text-rose-600",onClick:()=>i("/admin/rfqs")}],L=[{label:"Company",key:"companyName",render:s=>s.companyName||"N/A"},{label:"Contact",key:"contactName",render:s=>s.contactName||"N/A"},{label:"Items",key:"items",render:s=>{const t=s.items||[];return t.length===0?"N/A":`${t.length} product(s)`}},{label:"Status",key:"status",render:s=>e.jsx(m,{variant:s.status==="PENDING"?"warning":s.status==="RESPONDED"?"primary":"default",children:s.status||"PENDING"})},{label:"Date",key:"createdAt",render:s=>new Date(s.createdAt).toLocaleDateString()}],_=[{label:"Name",key:"companyName"},{label:"Type",key:"supplierType",render:s=>e.jsx(m,{variant:"default",children:s.supplierType?.replace("_"," ")||"N/A"})},{label:"Status",key:"status",render:s=>e.jsxs("div",{className:"flex gap-1",children:[s.isFeatured&&e.jsx(m,{variant:"featured",children:"Featured"}),s.isVerified&&e.jsx(m,{variant:"verified",children:"Verified"})]})}];return M?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-4 text-neutral-600",children:"Loading dashboard..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900",children:"Dashboard"}),e.jsx("p",{className:"text-neutral-600 mt-1",children:"Overview of your platform"})]}),e.jsxs(se,{onClick:w,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(K,{size:16})," Refresh"]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:U.map((s,t)=>e.jsxs("div",{onClick:s.onClick,className:"cursor-pointer bg-white rounded-xl shadow-sm border border-neutral-200/60 p-5 hover:shadow-md transition-shadow group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:`p-2.5 rounded-lg ${s.lightColor}`,children:s.icon}),e.jsx(ee,{size:16,className:"text-neutral-300 group-hover:text-neutral-500 transition-colors"})]}),e.jsx("div",{className:"text-3xl font-bold text-neutral-900 mb-0.5",children:s.value}),e.jsx("div",{className:"text-sm text-neutral-500",children:s.title})]},t))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200/60 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(k,{className:"text-primary-600",size:20}),e.jsx("h2",{className:"text-lg font-bold text-neutral-900",children:"RFQ Analytics"})]}),n&&Object.keys(n).length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-amber-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-700",children:n.pending||n.PENDING||a.pendingRfqs||0}),e.jsx("div",{className:"text-sm text-amber-600",children:"Pending RFQs"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:n.responded||n.RESPONDED||a.respondedRfqs||0}),e.jsx("div",{className:"text-sm text-blue-600",children:"Responded RFQs"})]})]}),(n.total!==void 0||a.rfqs>0)&&e.jsxs("div",{className:"text-sm text-neutral-500",children:["Total: ",n.total??a.rfqs??0," requests"]})]}):a.rfqs>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-amber-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-700",children:a.pendingRfqs||0}),e.jsx("div",{className:"text-sm text-amber-600",children:"Pending RFQs"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:a.respondedRfqs||0}),e.jsx("div",{className:"text-sm text-blue-600",children:"Responded RFQs"})]})]}),e.jsxs("div",{className:"text-sm text-neutral-500",children:["Total: ",a.rfqs," requests"]})]}):e.jsxs("div",{className:"text-center py-8 text-neutral-400",children:[e.jsx(k,{className:"mx-auto mb-2",size:32}),e.jsx("p",{className:"text-sm",children:"No analytics data yet"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200/60 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(P,{className:"text-emerald-600",size:20}),e.jsx("h2",{className:"text-lg font-bold text-neutral-900",children:"Top Products"})]}),v.length>0?e.jsx("div",{className:"space-y-3",children:v.slice(0,5).map((s,t)=>{const c=s.name||s.productName||s.Product?.name||s.product?.name||"Unknown",g=s.requestCount||s.request_count||s.count||s.rfqCount||s.totalQuantity||s.total_quantity||s.views||0;return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-neutral-100 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-bold text-neutral-400 w-6",children:["#",t+1]}),e.jsx("span",{className:"font-medium text-neutral-900 text-sm",children:c})]}),e.jsxs(m,{variant:"default",children:[g," requests"]})]},s.productId||s.id||t)})}):e.jsxs("div",{className:"text-center py-8 text-neutral-400",children:[e.jsx(P,{className:"mx-auto mb-2",size:32}),e.jsx("p",{className:"text-sm",children:"No popularity data yet"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200/60 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"text-violet-600",size:20}),e.jsx("h2",{className:"text-lg font-bold text-neutral-900",children:"Categories"})]}),e.jsx("button",{onClick:()=>i("/admin/categories"),className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Manage →"})]}),x.length>0?e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:x.filter(s=>!s.parentId).slice(0,8).map(s=>{const t=x.filter(c=>c.parentId===s.id);return e.jsxs("div",{className:"border border-neutral-100 rounded-lg p-3",children:[e.jsxs("div",{className:"font-medium text-neutral-900 text-sm flex items-center justify-between",children:[s.name,t.length>0&&e.jsxs("span",{className:"text-xs text-neutral-400",children:[t.length," sub"]})]}),t.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[t.slice(0,4).map(c=>e.jsx("span",{className:"inline-block px-2 py-0.5 bg-violet-50 text-violet-700 rounded text-xs",children:c.name},c.id)),t.length>4&&e.jsxs("span",{className:"text-xs text-neutral-400",children:["+",t.length-4," more"]})]})]},s.id)})}):e.jsxs("div",{className:"text-center py-8 text-neutral-400",children:[e.jsx(N,{className:"mx-auto mb-2",size:32}),e.jsx("p",{className:"text-sm",children:"No categories yet"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200/60 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"text-amber-600",size:20}),e.jsx("h2",{className:"text-lg font-bold text-neutral-900",children:"Industries"})]}),e.jsx("button",{onClick:()=>i("/admin/industries"),className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Manage →"})]}),p.length>0?e.jsx("div",{className:"flex flex-wrap gap-2 max-h-60 overflow-y-auto",children:p.map(s=>e.jsx("div",{className:"px-3 py-2 bg-amber-50 border border-amber-100 text-amber-800 rounded-lg text-sm font-medium",children:s.name},s.id))}):e.jsxs("div",{className:"text-center py-8 text-neutral-400",children:[e.jsx(j,{className:"mx-auto mb-2",size:32}),e.jsx("p",{className:"text-sm",children:"No industries yet"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200/60 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-neutral-200/60",children:[e.jsx("h2",{className:"text-lg font-bold text-neutral-900",children:"Recent RFQs"}),e.jsx("button",{onClick:()=>i("/admin/rfqs"),className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"View All →"})]}),y.length>0?e.jsx(z,{columns:L,data:y}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(F,{className:"mx-auto text-neutral-400 mb-3",size:40}),e.jsx("p",{className:"text-neutral-600",children:"No recent RFQs"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200/60 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-neutral-200/60",children:[e.jsx("h2",{className:"text-lg font-bold text-neutral-900",children:"Recent Suppliers"}),e.jsx("button",{onClick:()=>i("/admin/suppliers"),className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"View All →"})]}),h.length>0?e.jsx(z,{columns:_,data:h}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{className:"mx-auto text-neutral-400 mb-3",size:40}),e.jsx("p",{className:"text-neutral-600",children:"No recent suppliers"})]})]})]})]})};export{he as default};
