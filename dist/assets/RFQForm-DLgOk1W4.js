import{j as e}from"./vendor-query-Bcn4Fvtg.js";import{i as re,u as ae,r as t,R as te}from"./vendor-react-DbHp_wuh.js";import{u as ie,d as k,L as T,c as A,D as I,G as ne,n as L,j as h,H as N,h as ce,e as M,x as oe,y as le,v as de,I as v,Q as me,R as ue,E as he,K as fe,a as pe,J as xe,r as je}from"./index-CDJVr2wI.js";import{u as qe}from"./useRFQs-BfHvAP5M.js";import{p as Ne}from"./api--gIgMF1d.js";import"./vendor-icons-BV48wJe3.js";const ve=["gmail.com","yahoo.com","hotmail.com","outlook.com","live.com"],Se=()=>{const y=re(),R=ae(),{cart:E,clearCart:G}=ie(),O=t.useRef(null),d=y.state?.product,V=y.state?.quantity,b=y.state?.fromCart,[i,n]=t.useState(1),[B,f]=t.useState(null),[Y,K]=t.useState([]),[p,g]=t.useState(""),[H,x]=t.useState(!1),[j,J]=t.useState(""),[m,c]=t.useState(null),[o,u]=t.useState([]),[a,C]=t.useState({companyName:"",contactName:"",email:"",phone:"",country:"",message:""}),w=qe(),$=[{id:1,label:"Products",icon:h},{id:2,label:"Company",icon:N},{id:3,label:"Review",icon:I}];t.useEffect(()=>{(async()=>{try{const r=await Ne.getAll();K(r.data||r||[])}catch(r){console.error("Failed to fetch products:",r)}})()},[]),t.useEffect(()=>{d&&!b&&(o.find(r=>r.productId===d.id)||u([{productId:d.id,productName:d.name,quantity:V||1,imageUrl:d.imageUrl}]))},[d]),t.useEffect(()=>{if(b&&E.length>0){const s=E.map(r=>({productId:r.id,productName:r.name,quantity:r.quantity,imageUrl:r.imageUrl,price:r.prices?.[0]?.amount,currency:r.prices?.[0]?.currency}));u(s),G()}},[b]);const Q=Y.filter(s=>s.name.toLowerCase().includes(p.toLowerCase())&&!o.some(r=>r.productId===s.id)),W=s=>{if(!s)return"";const r=s.split("@")[1]?.toLowerCase();return r&&ve.includes(r)?"Corporate email required. Personal emails (Gmail, Yahoo, etc.) are not accepted.":""},X=s=>{const r=s.target.value;C({...a,email:r}),J(W(r))},_=s=>{u(r=>[...r,{productId:s.id,productName:s.name,quantity:1,imageUrl:s.imageUrl}]),g(""),x(!1)},Z=s=>{u(r=>r.filter(l=>l.productId!==s))},F=(s,r)=>{const l=Math.max(1,parseInt(r)||1);u(se=>se.map(P=>P.productId===s?{...P,quantity:l}:P))},q=s=>{C({...a,[s.target.name]:s.target.value})},S=o.length>0,z=a.companyName&&a.contactName&&a.email&&a.phone&&!j,U=()=>{i===1&&S?(n(2),window.scrollTo({top:0,behavior:"smooth"})):i===2&&z&&(n(3),window.scrollTo({top:0,behavior:"smooth"}))},D=()=>{i>1&&(n(i-1),window.scrollTo({top:0,behavior:"smooth"}))},ee=async s=>{if(s.preventDefault(),f(null),o.length===0){n(1);return}if(!a.companyName||!a.contactName||!a.email||!a.phone){n(2);return}if(j){n(2);return}try{const r={companyName:a.companyName.trim(),contactName:a.contactName.trim(),email:a.email.trim(),phone:a.phone.trim(),country:a.country.trim()||void 0,message:a.message.trim()||void 0,items:o.map(l=>({productId:l.productId,quantity:l.quantity}))};await w.mutateAsync(r),f("success"),u([]),C({companyName:"",contactName:"",email:"",phone:"",country:"",message:""}),n(1)}catch(r){console.error("RFQ submission error:",r),f("error")}};return t.useEffect(()=>{const s=r=>{r.target.closest(".rfq-product-search-wrapper")||x(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),e.jsxs("div",{className:"rfq-page",children:[e.jsxs("div",{className:"rfq-hero",children:[e.jsx("div",{className:"rfq-hero-bg",children:e.jsx("div",{className:"rfq-hero-pattern"})}),e.jsxs("div",{className:"rfq-hero-content",children:[e.jsxs("div",{className:"rfq-hero-badge",children:[e.jsx(k,{size:14}),e.jsx("span",{children:"Secure & Verified"})]}),e.jsxs("h1",{className:"rfq-hero-title",children:["Request for ",e.jsx("span",{children:"Quotation"})]}),e.jsx("p",{className:"rfq-hero-subtitle",children:"Select products, provide your details, and receive competitive quotes from verified suppliers"}),e.jsxs("div",{className:"rfq-hero-stats",children:[e.jsxs("div",{className:"rfq-hero-stat",children:[e.jsx(T,{size:16}),e.jsx("span",{children:"Response within 24hrs"})]}),e.jsxs("div",{className:"rfq-hero-stat",children:[e.jsx(A,{size:16}),e.jsx("span",{children:"Best Price Guarantee"})]}),e.jsxs("div",{className:"rfq-hero-stat",children:[e.jsx(k,{size:16}),e.jsx("span",{children:"Verified Suppliers"})]})]})]})]}),e.jsxs("div",{className:"rfq-main",children:[B==="success"&&e.jsx("div",{className:"rfq-success-overlay",children:e.jsxs("div",{className:"rfq-success-modal",children:[e.jsx("div",{className:"rfq-success-icon",children:e.jsx(I,{size:48})}),e.jsx("h2",{children:"RFQ Submitted Successfully!"}),e.jsx("p",{children:"Thank you for your request. Our team will review and respond within 24-48 business hours."}),e.jsxs("div",{className:"rfq-success-actions",children:[e.jsx("button",{className:"rfq-btn rfq-btn-primary",onClick:()=>f(null),children:"Submit Another RFQ"}),e.jsx("button",{className:"rfq-btn rfq-btn-secondary",onClick:()=>R("/products"),children:"Browse Products"})]})]})}),B==="error"&&e.jsxs("div",{className:"rfq-toast rfq-toast-error",children:[e.jsx(ne,{size:20}),e.jsx("span",{children:"Submission failed. Please check your details and try again."}),e.jsx("button",{onClick:()=>f(null),children:e.jsx(L,{size:16})})]}),e.jsx("div",{className:"rfq-steps-container",children:e.jsx("div",{className:"rfq-steps",children:$.map((s,r)=>e.jsxs(te.Fragment,{children:[e.jsxs("div",{className:`rfq-step ${i===s.id?"active":""} ${i>s.id?"completed":""}`,onClick:()=>{s.id<i?n(s.id):s.id===2&&S?n(2):s.id===3&&z&&n(3)},children:[e.jsx("div",{className:"rfq-step-indicator",children:i>s.id?e.jsx(ce,{size:16}):e.jsx(s.icon,{size:16})}),e.jsx("span",{className:"rfq-step-label",children:s.label})]}),r<$.length-1&&e.jsx("div",{className:`rfq-step-line ${i>s.id?"completed":""}`})]},s.id))})}),e.jsxs("form",{ref:O,onSubmit:ee,className:"rfq-form-container",children:[e.jsx("div",{className:`rfq-form-step ${i===1?"active":""}`,children:e.jsxs("div",{className:"rfq-form-card",children:[e.jsxs("div",{className:"rfq-form-header",children:[e.jsx("div",{className:"rfq-form-header-icon",children:e.jsx(h,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Select Products"}),e.jsx("p",{children:"Search and add products you want to request quotes for"})]})]}),e.jsxs("div",{className:"rfq-product-search-wrapper",children:[e.jsxs("div",{className:"rfq-product-search",children:[e.jsx(M,{className:"rfq-search-icon",size:20}),e.jsx("input",{type:"text",value:p,onChange:s=>{g(s.target.value),x(!0)},onFocus:()=>x(!0),placeholder:"Search products by name..."}),p&&e.jsx("button",{type:"button",className:"rfq-search-clear",onClick:()=>{g(""),x(!1)},children:e.jsx(L,{size:16})})]}),H&&p&&e.jsx("div",{className:"rfq-product-dropdown",children:Q.length>0?Q.slice(0,8).map(s=>e.jsxs("button",{type:"button",className:"rfq-product-option",onClick:()=>_(s),children:[e.jsx("div",{className:"rfq-product-option-img",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.name}):e.jsx(h,{size:20})}),e.jsxs("div",{className:"rfq-product-option-info",children:[e.jsx("span",{className:"rfq-product-option-name",children:s.name}),e.jsx("span",{className:"rfq-product-option-category",children:s.category?.name||"Uncategorized"})]}),e.jsx(oe,{className:"rfq-product-option-add",size:18})]},s.id)):e.jsxs("div",{className:"rfq-product-empty",children:[e.jsx(M,{size:24}),e.jsxs("span",{children:['No products found matching "',p,'"']})]})})]}),o.length>0?e.jsxs("div",{className:"rfq-cart",children:[e.jsxs("div",{className:"rfq-cart-header",children:[e.jsxs("span",{children:[o.length," Product",o.length!==1?"s":""," Selected"]}),e.jsxs("span",{className:"rfq-cart-total",children:["Total Qty: ",o.reduce((s,r)=>s+r.quantity,0)]})]}),e.jsx("div",{className:"rfq-cart-items",children:o.map((s,r)=>e.jsxs("div",{className:"rfq-cart-item",children:[e.jsx("div",{className:"rfq-cart-item-img",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.productName}):e.jsx(h,{size:20})}),e.jsxs("div",{className:"rfq-cart-item-info",children:[e.jsx("span",{className:"rfq-cart-item-name",children:s.productName}),e.jsxs("span",{className:"rfq-cart-item-idx",children:["Item #",r+1]})]}),e.jsxs("div",{className:"rfq-cart-item-qty",children:[e.jsx("button",{type:"button",onClick:()=>F(s.productId,s.quantity-1),disabled:s.quantity<=1,children:"-"}),e.jsx("input",{type:"number",min:"1",value:s.quantity,onChange:l=>F(s.productId,l.target.value)}),e.jsx("button",{type:"button",onClick:()=>F(s.productId,s.quantity+1),children:"+"})]}),e.jsx("button",{type:"button",className:"rfq-cart-item-remove",onClick:()=>Z(s.productId),children:e.jsx(le,{size:16})})]},s.productId))})]}):e.jsxs("div",{className:"rfq-cart-empty",children:[e.jsx(de,{size:48}),e.jsx("h3",{children:"No products selected"}),e.jsx("p",{children:"Search products above or browse our catalog to add items to your quote request"}),e.jsxs("button",{type:"button",className:"rfq-btn rfq-btn-browse",onClick:()=>R("/products"),children:[e.jsx(h,{size:18}),"Browse Products"]})]}),e.jsxs("div",{className:"rfq-form-actions",children:[e.jsx("div",{}),e.jsxs("button",{type:"button",className:"rfq-btn rfq-btn-primary",disabled:!S,onClick:U,children:["Continue to Details",e.jsx(v,{className:"rfq-btn-icon-right",style:{transform:"rotate(-90deg)"}})]})]})]})}),e.jsx("div",{className:`rfq-form-step ${i===2?"active":""}`,children:e.jsxs("div",{className:"rfq-form-card",children:[e.jsxs("div",{className:"rfq-form-header",children:[e.jsx("div",{className:"rfq-form-header-icon",children:e.jsx(N,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Company Details"}),e.jsx("p",{children:"Tell us about yourself and how to reach you"})]})]}),e.jsxs("div",{className:"rfq-notice",children:[e.jsx(me,{size:18}),e.jsx("span",{children:"Please use your corporate email address. Personal emails (Gmail, Yahoo, etc.) are not accepted for business inquiries."})]}),e.jsxs("div",{className:"rfq-form-grid",children:[e.jsxs("div",{className:`rfq-field ${m==="companyName"||a.companyName?"focused":""}`,children:[e.jsx(N,{className:"rfq-field-icon",size:18}),e.jsx("input",{type:"text",id:"companyName",name:"companyName",value:a.companyName,onChange:q,onFocus:()=>c("companyName"),onBlur:()=>c(null),required:!0,autoComplete:"organization"}),e.jsx("label",{htmlFor:"companyName",children:"Company Name *"})]}),e.jsxs("div",{className:`rfq-field ${m==="contactName"||a.contactName?"focused":""}`,children:[e.jsx(ue,{className:"rfq-field-icon",size:18}),e.jsx("input",{type:"text",id:"contactName",name:"contactName",value:a.contactName,onChange:q,onFocus:()=>c("contactName"),onBlur:()=>c(null),required:!0,autoComplete:"name"}),e.jsx("label",{htmlFor:"contactName",children:"Contact Person *"})]}),e.jsxs("div",{className:`rfq-field ${m==="email"||a.email?"focused":""} ${j?"error":""}`,children:[e.jsx(he,{className:"rfq-field-icon",size:18}),e.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:X,onFocus:()=>c("email"),onBlur:()=>c(null),required:!0,autoComplete:"email"}),e.jsx("label",{htmlFor:"email",children:"Corporate Email *"}),j&&e.jsx("span",{className:"rfq-field-error",children:j})]}),e.jsxs("div",{className:`rfq-field ${m==="phone"||a.phone?"focused":""}`,children:[e.jsx(fe,{className:"rfq-field-icon",size:18}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:a.phone,onChange:q,onFocus:()=>c("phone"),onBlur:()=>c(null),required:!0,autoComplete:"tel",placeholder:""}),e.jsx("label",{htmlFor:"phone",children:"Phone Number *"})]}),e.jsxs("div",{className:`rfq-field rfq-field-full ${m==="country"||a.country?"focused":""}`,children:[e.jsx(pe,{className:"rfq-field-icon",size:18}),e.jsx("input",{type:"text",id:"country",name:"country",value:a.country,onChange:q,onFocus:()=>c("country"),onBlur:()=>c(null),autoComplete:"country-name"}),e.jsx("label",{htmlFor:"country",children:"Country / Region"})]}),e.jsxs("div",{className:`rfq-field rfq-field-full rfq-field-textarea ${m==="message"||a.message?"focused":""}`,children:[e.jsx(xe,{className:"rfq-field-icon",size:18}),e.jsx("textarea",{id:"message",name:"message",value:a.message,onChange:q,onFocus:()=>c("message"),onBlur:()=>c(null),rows:"4"}),e.jsx("label",{htmlFor:"message",children:"Additional Requirements"})]})]}),e.jsxs("div",{className:"rfq-form-actions",children:[e.jsxs("button",{type:"button",className:"rfq-btn rfq-btn-secondary",onClick:D,children:[e.jsx(v,{className:"rfq-btn-icon-left",style:{transform:"rotate(90deg)"}}),"Back"]}),e.jsxs("button",{type:"button",className:"rfq-btn rfq-btn-primary",disabled:!z,onClick:U,children:["Review & Submit",e.jsx(v,{className:"rfq-btn-icon-right",style:{transform:"rotate(-90deg)"}})]})]})]})}),e.jsx("div",{className:`rfq-form-step ${i===3?"active":""}`,children:e.jsxs("div",{className:"rfq-form-card",children:[e.jsxs("div",{className:"rfq-form-header",children:[e.jsx("div",{className:"rfq-form-header-icon",children:e.jsx(I,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Review Your Request"}),e.jsx("p",{children:"Please verify all details before submission"})]})]}),e.jsxs("div",{className:"rfq-review",children:[e.jsxs("div",{className:"rfq-review-section",children:[e.jsxs("div",{className:"rfq-review-section-header",children:[e.jsx(h,{size:18}),e.jsxs("span",{children:["Products (",o.length,")"]}),e.jsx("button",{type:"button",onClick:()=>n(1),children:"Edit"})]}),e.jsx("div",{className:"rfq-review-products",children:o.map(s=>e.jsxs("div",{className:"rfq-review-product",children:[e.jsx("span",{className:"rfq-review-product-name",children:s.productName}),e.jsxs("span",{className:"rfq-review-product-qty",children:["Qty: ",s.quantity]})]},s.productId))})]}),e.jsxs("div",{className:"rfq-review-section",children:[e.jsxs("div",{className:"rfq-review-section-header",children:[e.jsx(N,{size:18}),e.jsx("span",{children:"Contact Information"}),e.jsx("button",{type:"button",onClick:()=>n(2),children:"Edit"})]}),e.jsxs("div",{className:"rfq-review-details",children:[e.jsxs("div",{className:"rfq-review-detail",children:[e.jsx("span",{children:"Company"}),e.jsx("strong",{children:a.companyName})]}),e.jsxs("div",{className:"rfq-review-detail",children:[e.jsx("span",{children:"Contact"}),e.jsx("strong",{children:a.contactName})]}),e.jsxs("div",{className:"rfq-review-detail",children:[e.jsx("span",{children:"Email"}),e.jsx("strong",{children:a.email})]}),e.jsxs("div",{className:"rfq-review-detail",children:[e.jsx("span",{children:"Phone"}),e.jsx("strong",{children:a.phone})]}),a.country&&e.jsxs("div",{className:"rfq-review-detail",children:[e.jsx("span",{children:"Country"}),e.jsx("strong",{children:a.country})]}),a.message&&e.jsxs("div",{className:"rfq-review-detail rfq-review-detail-full",children:[e.jsx("span",{children:"Message"}),e.jsx("strong",{children:a.message})]})]})]})]}),e.jsxs("p",{className:"rfq-terms",children:["By submitting this request, you agree to our ",e.jsx("a",{href:"/terms",children:"Terms of Service"})," and ",e.jsx("a",{href:"/privacy",children:"Privacy Policy"}),". We'll contact you within 24-48 business hours."]}),e.jsxs("div",{className:"rfq-form-actions",children:[e.jsxs("button",{type:"button",className:"rfq-btn rfq-btn-secondary",onClick:D,children:[e.jsx(v,{className:"rfq-btn-icon-left",style:{transform:"rotate(90deg)"}}),"Back"]}),e.jsx("button",{type:"submit",className:"rfq-btn rfq-btn-submit",disabled:w.isPending,children:w.isPending?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"rfq-btn-spinner"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{size:18}),"Submit RFQ"]})})]})]})})]}),e.jsxs("div",{className:"rfq-trust",children:[e.jsxs("div",{className:"rfq-trust-item",children:[e.jsx(k,{size:20}),e.jsx("span",{children:"SSL Secured"})]}),e.jsxs("div",{className:"rfq-trust-item",children:[e.jsx(T,{size:20}),e.jsx("span",{children:"24hr Response"})]}),e.jsxs("div",{className:"rfq-trust-item",children:[e.jsx(A,{size:20}),e.jsx("span",{children:"Verified Suppliers"})]})]})]})]})};export{Se as default};
